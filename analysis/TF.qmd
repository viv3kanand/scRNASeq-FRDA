---
title: "Transcription Factor Enrichment"
format: html
editor: source
author: viv3kanand
date: "`r format(Sys.time(), '%d %B, %Y')`"
---

## Prerequisites

### Option presets

```{r}
#| label: options
#| echo: false
#| eval: true
#| warning: false

options(Seurat.object.assay.calcn = TRUE)
options(renv.config.pak.enabled = TRUE)

```

### Installation

```{r}
#| label: install packages
#| echo: true
#| eval: false

renv::install("saezlab/decoupleR")
renv::install("saezlab/OmnipathR")

```

### Load required libraries

```{r}
#| label: load packages
#| echo: true
#| eval: true
#| message: false
#| warning: false

require(tidyverse)
require(decoupleR)
require(OmnipathR)
require(Seurat)

```

## Transcription Factor Enrichment

### Load data

```{r}
#| label: load data
#| echo: true
#| eval: true

seu_PBMC <- read_rds("../data/2024-11-22_seurat_obj_PBMC.rds")
seu_WB <- read_rds("../data/2024-10-17_seurat_obj_WB.rds")
```

### Download databases

```{r}
#| label: download databases
#| echo: true
#| eval: true

net_TF <- decoupleR::get_collectri(organism = 'human', 
                                   split_complexes = FALSE)

```

### Run ulm

```{r}
#| label: download databases
#| echo: true
#| eval: true

acts_TF <- decoupleR::run_ulm(mat = as.matrix(seu_WB@assays$RNA$data), 
                              net = net_TF, 
                              .source = 'source',
                              .target = 'target',
                              .mor='mor', 
                              minsize = 5)

```







